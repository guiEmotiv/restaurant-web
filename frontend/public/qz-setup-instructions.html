<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instalaci√≥n QZ Tray - El Fog√≥n de Don Soto</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; line-height: 1.6; }
        .step { background: #f5f5f5; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .code { background: #1a1a1a; color: #00ff00; padding: 10px; border-radius: 5px; font-family: monospace; }
        .warning { background: #fff3cd; border: 1px solid #ffeaa7; padding: 10px; border-radius: 5px; }
        .success { background: #d4edda; border: 1px solid #c3e6cb; padding: 10px; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>üñ®Ô∏è Instalaci√≥n QZ Tray para Impresi√≥n UTF-8</h1>
    <p>Gu√≠a para configurar impresi√≥n t√©rmica con soporte completo de caracteres especiales (FOG√ìN, ¬°, √±, etc.)</p>

    <h2>üìã Requisitos Previos</h2>
    <div class="step">
        <h3>1. Impresora HOIN POS-58 (H58/H200)</h3>
        <ul>
            <li><strong>Nombre Bluetooth:</strong> "Bluetooth Printer"</li>
            <li><strong>PIN:</strong> 1234</li>
            <li><strong>MAC:</strong> 66:32:35:92:92:26</li>
            <li><strong>Papel:</strong> 58mm (384px ancho √∫til)</li>
        </ul>
    </div>

    <h2>üîß Instalaci√≥n Paso a Paso</h2>

    <div class="step">
        <h3>Paso 1: Emparejar Impresora Bluetooth</h3>
        <p><strong>Windows:</strong></p>
        <ol>
            <li>Ir a Configuraci√≥n ‚Üí Bluetooth y dispositivos</li>
            <li>Agregar dispositivo ‚Üí Bluetooth</li>
            <li>Seleccionar "Bluetooth Printer"</li>
            <li>Introducir PIN: <code>1234</code></li>
            <li>Verificar que se cree un puerto COM (ej: COM3, COM4)</li>
        </ol>
        
        <p><strong>macOS:</strong></p>
        <ol>
            <li>Preferencias del Sistema ‚Üí Bluetooth</li>
            <li>Conectar "Bluetooth Printer"</li>
            <li>PIN: <code>1234</code></li>
        </ol>

        <p><strong>Linux:</strong></p>
        <div class="code">
sudo bluetoothctl
scan on
pair 66:32:35:92:92:26
connect 66:32:35:92:92:26
        </div>
    </div>

    <div class="step">
        <h3>Paso 2: Instalar QZ Tray</h3>
        <ol>
            <li>Descargar QZ Tray desde: <a href="https://qz.io/download/" target="_blank">https://qz.io/download/</a></li>
            <li>Instalar y ejecutar QZ Tray</li>
            <li>Verificar que est√© ejecut√°ndose en bandeja del sistema</li>
        </ol>
    </div>

    <div class="step">
        <h3>Paso 3: Configurar Certificado de Desarrollo</h3>
        <p>QZ Tray requiere certificados HTTPS. Para desarrollo:</p>
        <ol>
            <li>Ir a QZ Tray ‚Üí Advanced ‚Üí Allow Insecure</li>
            <li>Habilitar "Allow HTTP/Insecure"</li>
            <li>Reiniciar QZ Tray</li>
        </ol>
    </div>

    <div class="step">
        <h3>Paso 4: Cargar QZ Tray en la Aplicaci√≥n</h3>
        <p>Agregar el script QZ Tray al HTML de la aplicaci√≥n:</p>
        <div class="code">
&lt;script src="https://cdn.jsdelivr.net/npm/qz-tray@2.2.4/qz-tray.js"&gt;&lt;/script&gt;
        </div>
        <p>O descargar y servir localmente para mejor seguridad.</p>
    </div>

    <h2>‚úÖ Verificaci√≥n</h2>
    <div class="success">
        <h3>C√≥mo verificar que todo funciona:</h3>
        <ol>
            <li>Abrir la aplicaci√≥n web</li>
            <li>Ir a Historial ‚Üí Ver recibo de cualquier pago</li>
            <li>Debe aparecer la secci√≥n "QZ Tray (UTF-8 Completo)"</li>
            <li>Status debe mostrar: "‚úÖ QZ Tray disponible"</li>
            <li>Probar con "üîß Test QZ Tray"</li>
            <li>Debe imprimir ticket con "FOG√ìN" y "¬°" correctamente</li>
        </ol>
    </div>

    <h2>üö® Soluci√≥n de Problemas</h2>

    <div class="warning">
        <h3>‚ùå "QZ Tray no detectado"</h3>
        <ul>
            <li>Verificar que QZ Tray est√© ejecut√°ndose</li>
            <li>Recargar la p√°gina web</li>
            <li>Verificar que el script qz-tray.js se carga correctamente</li>
            <li>En consola del navegador ejecutar: <code>console.log(typeof qz)</code></li>
        </ul>
    </div>

    <div class="warning">
        <h3>‚ùå "Impresora no encontrada"</h3>
        <ul>
            <li>Verificar que la impresora est√© emparejada y conectada</li>
            <li>Windows: Verificar puerto COM en Administrador de dispositivos</li>
            <li>Usar di√°logo de selecci√≥n manual si el nombre no coincide</li>
            <li>Probar reconectar la impresora</li>
        </ul>
    </div>

    <div class="warning">
        <h3>‚ùå Errores de certificado</h3>
        <ul>
            <li>Asegurar que QZ Tray permita conexiones inseguras para desarrollo</li>
            <li>Para producci√≥n, configurar certificados SSL v√°lidos</li>
            <li>Reiniciar QZ Tray despu√©s de cambios de certificado</li>
        </ul>
    </div>

    <h2>üìä Comparaci√≥n de M√©todos</h2>
    <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
        <thead>
            <tr style="background: #f8f9fa;">
                <th style="border: 1px solid #ddd; padding: 8px;">Caracter√≠stica</th>
                <th style="border: 1px solid #ddd; padding: 8px;">Web Bluetooth API</th>
                <th style="border: 1px solid #ddd; padding: 8px;">QZ Tray</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td style="border: 1px solid #ddd; padding: 8px;">Caracteres UTF-8</td>
                <td style="border: 1px solid #ddd; padding: 8px;">‚ùå Problem√°ticos</td>
                <td style="border: 1px solid #ddd; padding: 8px;">‚úÖ Perfecto</td>
            </tr>
            <tr>
                <td style="border: 1px solid #ddd; padding: 8px;">FOG√ìN con tilde</td>
                <td style="border: 1px solid #ddd; padding: 8px;">‚ùå Se ve raro</td>
                <td style="border: 1px solid #ddd; padding: 8px;">‚úÖ Perfecto</td>
            </tr>
            <tr>
                <td style="border: 1px solid #ddd; padding: 8px;">¬° de apertura</td>
                <td style="border: 1px solid #ddd; padding: 8px;">‚ùå Se ve raro</td>
                <td style="border: 1px solid #ddd; padding: 8px;">‚úÖ Perfecto</td>
            </tr>
            <tr>
                <td style="border: 1px solid #ddd; padding: 8px;">Instalaci√≥n</td>
                <td style="border: 1px solid #ddd; padding: 8px;">‚úÖ Ninguna</td>
                <td style="border: 1px solid #ddd; padding: 8px;">‚ö†Ô∏è Requiere QZ Tray</td>
            </tr>
            <tr>
                <td style="border: 1px solid #ddd; padding: 8px;">Compatibilidad</td>
                <td style="border: 1px solid #ddd; padding: 8px;">‚ö†Ô∏è Solo Chrome/Edge</td>
                <td style="border: 1px solid #ddd; padding: 8px;">‚úÖ Todos los navegadores</td>
            </tr>
            <tr>
                <td style="border: 1px solid #ddd; padding: 8px;">Estabilidad</td>
                <td style="border: 1px solid #ddd; padding: 8px;">‚ö†Ô∏è Experimental</td>
                <td style="border: 1px solid #ddd; padding: 8px;">‚úÖ Robusto</td>
            </tr>
        </tbody>
    </table>

    <h2>üéØ Recomendaci√≥n</h2>
    <div class="success">
        <p><strong>Para uso en producci√≥n:</strong> Usar QZ Tray para impresi√≥n perfecta de caracteres especiales.</p>
        <p><strong>Para desarrollo r√°pido:</strong> Web Bluetooth API como respaldo.</p>
        <p><strong>Configuraci√≥n ideal:</strong> Ambos m√©todos disponibles para m√°xima flexibilidad.</p>
    </div>

    <footer style="margin-top: 40px; text-align: center; color: #666;">
        <p>El Fog√≥n de Don Soto - Sistema de Impresi√≥n T√©rmica</p>
        <p>Documentaci√≥n t√©cnica generada autom√°ticamente</p>
    </footer>
</body>
</html>